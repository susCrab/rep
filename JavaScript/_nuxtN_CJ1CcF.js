import{_ as e}from"./CjASlAzE.js";import{_ as a}from"./Kybo8F-N.js";import i from"./DV_J6UB0.js";import{l as s,b as r,F as t,G as l,H as o,N as n,X as d,W as c,I as u,J as m,u as p,ac as v,L as _,a5 as g,a3 as w,O as h,V as f,M as k,a8 as y,a9 as C,aa as b,a7 as x,ab as M}from"./CfmBXBX3.js";import{g as L}from"./D1BoCpNp.js";import{b as j,h as B,a as G,k as S,A as F}from"./B5Cna7aG.js";import{a as A}from"./Cw_W7H_9.js";const K=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),V={class:"game-card"},$=["src"],H={class:"game-card__name_inner"},I={class:"game-card__prices prices"},N={key:0,class:"prices__discount"},P={class:"prices__price"},Z=["href"],E=j({__name:"VerticalGameCard",props:{game:{default:{}}},setup(f){const k=B(),y=s((()=>k.favoritesList.items)),C=r(!1);A((()=>y.value),(()=>{var e,a,i;const s=null==(e=y.value)?void 0:e.map((e=>{var a;return null==(a=null==e?void 0:e.product)?void 0:a.id}));C.value=null==(i=null==(a=f.game)?void 0:a.products)?void 0:i.some((e=>null==s?void 0:s.includes(null==e?void 0:e.id)))}),{deep:!0});const b=s((()=>f.game.min_price?100-(f.game.min_price[j.value]/f.game.min_old_price[j.value]*100).toFixed(0):null)),x=s((()=>f.game.min_price?K(Math.round(f.game.min_gold_price[j.value])):"-")),M=s((()=>f.game.min_price?K(Math.round(f.game.min_old_price[j.value])):"-")),j=s((()=>k.userCurrency&&"unknown"!==k.userCurrency?k.userCurrency:"rub")),E=G(),O=S(),Q=r(!1);t((()=>{Q.value=F("access_token")}));return(s,r)=>{var t,y,j,B,G,S;const F=e,A=a,K=i;return l(),o("div",V,[f.game.more?(l(),o("a",{key:1,href:f.game.more,class:"game-card__more more-card"},[(l(),o(n,null,h(6,(e=>u("div",{class:"more-card__backdrop-item",key:e}))),64)),r[4]||(r[4]=u("button",{class:"more-card__btn"},"Больше →",-1))],8,Z)):(l(),o(n,{key:0},[d(F,{to:f.game.more||`/ru-ru/games/${f.game.slug??""}`,class:m(["game-card__img",{"game-card__img__liked":p(C)}])},{default:c((()=>{var e,a,i,s;return[u("img",{src:(null==(a=null==(e=f.game)?void 0:e.external_data)?void 0:a.header_vertical)||(null==(s=null==(i=f.game)?void 0:i.external_data)?void 0:s.header_image),alt:""},null,8,$),(l(),o("div",{key:0,class:m(["game-card__like",{"game-card__like--active":p(C)}]),onClick:r[0]||(r[0]=v((e=>(async()=>{Q.value?(await k.setFavoriteGame({projectId:f.game.products[0].id}),C.value=!C.value,setTimeout((async()=>{await k.getFavoritesListHidden()}),2e3)):await E.openModalQuery({name:"telegram",noQuery:!0})})()),["stop","prevent"]))},r[2]||(r[2]=[u("svg",{width:"17",height:"16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M5.4 1.7a4.2 4.2 0 0 1 3.5 1h0a4.3 4.3 0 0 1 3.4-1h.2a4.2 4.2 0 0 1 2.4 7l-.2.2h0l-5.3 5.3a.7.7 0 0 1-1 0h0L3.1 8.9a4.2 4.2 0 0 1 2.3-7.2Z",stroke:"#fff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2)),(l(),o("div",{key:1,class:m(["game-card__similar",{"game-card__similar":!0}]),onClick:r[1]||(r[1]=v((e=>(async e=>await O.push(`/ru-ru/games/${e}/related`))(f.game.slug)),["stop","prevent"]))},r[3]||(r[3]=[u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},[u("path",{d:"M17 9.0625V4.375C17 3.87772 16.7893 3.40081 16.4142 3.04917C16.0391 2.69754 15.5304 2.5 15 2.5H5C4.46957 2.5 3.96086 2.69754 3.58579 3.04917C3.21071 3.40081 3 3.87772 3 4.375V13.75C3 14.2473 3.21071 14.7242 3.58579 15.0758C3.96086 15.4275 4.46957 15.625 5 15.625H8M15.5 15.1562L18 17.5M11 13.2812C11 13.9029 11.2634 14.499 11.7322 14.9385C12.2011 15.3781 12.837 15.625 13.5 15.625C14.163 15.625 14.7989 15.3781 15.2678 14.9385C15.7366 14.499 16 13.9029 16 13.2812C16 12.6596 15.7366 12.0635 15.2678 11.624C14.7989 11.1844 14.163 10.9375 13.5 10.9375C12.837 10.9375 12.2011 11.1844 11.7322 11.624C11.2634 12.0635 11 12.6596 11 13.2812Z",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),g(" Похожее ")])))]})),_:1},8,["to","class"]),d(F,{to:f.game.more||`/ru-ru/games/${f.game.slug??""}`,class:"game-card__name"},{default:c((()=>[d(A,{width:"80%",loading:f.game.loading},{default:c((()=>{var e;return[u("p",H,w(null==(e=f.game)?void 0:e.name),1)]})),_:1},8,["loading"])])),_:1},8,["to"]),(null==(y=null==(t=f.game)?void 0:t.reviews)?void 0:y.percent_positive_reviews)?(l(),o("div",{key:0,class:m(["game-card__reviews","game-card__reviews--"+((null==(B=null==(j=f.game)?void 0:j.reviews)?void 0:B.percent_positive_reviews)>39?(null==(S=null==(G=f.game)?void 0:G.reviews)?void 0:S.percent_positive_reviews)>69?"green":"yellow":"red")])},[d(A,{width:"60%",loading:f.game.loading},{default:c((()=>{var e,a,i,s,r,t;return[g(w(p(L)(Math.ceil(null==(a=null==(e=f.game)?void 0:e.reviews)?void 0:a.percent_positive_reviews),(null==(s=null==(i=f.game)?void 0:i.reviews)?void 0:s.total_positive)+(null==(t=null==(r=f.game)?void 0:r.reviews)?void 0:t.total_negative))),1)]})),_:1},8,["loading"])],2)):_("",!0),u("div",I,[d(A,{width:"45%",loading:f.game.loading},{default:c((()=>[p(b)?(l(),o("div",N," -"+w(p(b))+"% ",1)):_("",!0),u("div",P,[g(w(p(x))+" ",1),d(K,{class:"prices__price--gold"})]),u("div",{class:m(["prices__second-price",{"prices__second-price--old":p(b)}])},w(p(M))+" ₽ ",3)])),_:1},8,["loading"])])],64))])}}},[["__scopeId","data-v-8af98c6b"]]),O={class:"card-list"},Q={class:"card-list__header"},T={class:"card-list__title"},q={class:"card-list__controls"},z=j({__name:"VerticalGameCardContainer",props:{link:{default:!1},filter:{type:Object,default:{}},title:{type:String||Boolean,default:!1},items:{type:Array||Boolean,default:!1},controlKey:{type:Number,default:0}},async setup(a){const i=B(),v=r(null),L=s((()=>{const e=new Array(0);return a.items?e.push(...a.items):v.value?e.push(...v.value):e.push(...new Array(6).fill({loading:!0})),a.link&&e.push({more:a.link}),e}));t((()=>{a.items||(async e=>{try{const{data:a}=await $fetch("https://steam.kupikod.com/backend/api/games",{query:e}),s=a.splice(0,17),r=i.favoritesList.items.map((e=>e.product.id));v.value=s.map((e=>e.products.some((e=>r.includes(e.id)))?(e.isFavorite=!0,e):e))}catch{}})(a.filter)}));let j=r({nextEl:"."+("contr-next"+a.controlKey),prevEl:"."+("contr-pre"+a.controlKey)});return(i,s)=>{const r=e,t=E,v=x,B=M;return l(),o("div",O,[u("div",Q,[a.title?(l(),f(r,{key:0,class:m(["card-list__link",{"pointer-events-none":!a.link}]),to:a.link},{default:c((()=>[u("h2",T,[k(i.$slots,"tag",{},void 0,!0),g(" "+w(a.title),1)])])),_:3},8,["to","class"])):_("",!0),u("div",q,[u("button",{name:"back-button",class:m(["contr-pre"+a.controlKey,"card-list__control swiper-my-button-prev"])},s[0]||(s[0]=[u("svg",{width:"17",height:"23",viewBox:"0 0 17 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M6.68357 11.0039L10.9562 16.1921C11.3182 16.6318 11.2553 17.2817 10.8157 17.6437C10.3761 18.0058 9.72614 17.9429 9.36408 17.5032L4.55158 11.6595C4.23798 11.2787 4.23798 10.7292 4.55158 10.3484L9.36408 4.50461C9.72614 4.06496 10.3761 4.00207 10.8157 4.36413C11.2553 4.72619 11.3182 5.37611 10.9562 5.81576L6.68357 11.0039Z",fill:"white"})],-1)]),2),u("button",{name:"forward-button",class:m(["contr-next"+a.controlKey,"card-list__control swiper-my-button-next"])},s[1]||(s[1]=[u("svg",{width:"16",height:"22",viewBox:"0 0 16 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[u("path",{d:"M9.32034 11L5.04773 5.8118C4.68566 5.37215 4.74856 4.72224 5.18821 4.36018C5.62785 3.99811 6.27777 4.06101 6.63983 4.50066L11.4523 10.3444C11.7659 10.7252 11.7659 11.2748 11.4523 11.6555L6.63983 17.4993C6.27777 17.9389 5.62785 18.0018 5.18821 17.6398C4.74856 17.2777 4.68566 16.6278 5.04773 16.1881L9.32034 11Z",fill:"white"})],-1)]),2)])]),d(B,{breakpoints:{1920:{spaceBetween:24,slidesPerGroup:6},1440:{spaceBetween:16,slidesPerGroup:6},768:{spaceBetween:12,slidesPerGroup:4},360:{spaceBetween:12,slidesPerGroup:1}},"slides-per-view":"auto",modules:["SwiperMousewheel"in i?i.SwiperMousewheel:p(y),"SwiperFreeMode"in i?i.SwiperFreeMode:p(C),"SwiperNavigation"in i?i.SwiperNavigation:p(b)],navigation:p(j),freeMode:{enabled:!0},mousewheel:{forceToAxis:!0}},{default:c((()=>[(l(!0),o(n,null,h(p(L),((e,a)=>(l(),f(v,{class:"card-list__slide",key:a+e.id+(e.loading??"loaded")},{default:c((()=>[d(t,{game:e},null,8,["game"])])),_:2},1024)))),128))])),_:1},8,["modules","navigation"])])}}},[["__scopeId","data-v-93610712"]]);export{z as _};